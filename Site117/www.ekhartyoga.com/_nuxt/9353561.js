(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{332:function(e,t,r){"use strict";r.r(t),r.d(t,"namespaced",(function(){return d})),r.d(t,"state",(function(){return m})),r.d(t,"getters",(function(){return S})),r.d(t,"mutations",(function(){return R})),r.d(t,"actions",(function(){return T}));var n,o,c=r(0),l=r(4),f=r.n(l),E=r(7),d=!0;!function(e){e.DTO="dto"}(o||(o={}));var O,m=function(){return Object(c.a)({},o.DTO,{description:"",title:"",rootRouteTitle:""})},S=Object(E.d)(m,Object(c.a)({},o.DTO,(function(e){return e[o.DTO]})));!function(e){e.RESET="RESET",e.SET="SET"}(O||(O={}));var R=Object(E.e)(m,(n={},Object(c.a)(n,O.SET,(function(e,t){return f.a.set(e,t.key,t.data)})),Object(c.a)(n,O.RESET,(function(e){e.dto={description:"",title:"",rootRouteTitle:""}})),n)),T=Object(E.a)({state:m,getters:S,mutations:R},{setPublicHeaderDto:function(e,t){t&&e.commit(O.SET,{key:o.DTO,data:t})}})},339:function(e,t,r){"use strict";r.r(t),r.d(t,"namespaced",(function(){return C})),r.d(t,"state",(function(){return k})),r.d(t,"getters",(function(){return I})),r.d(t,"mutations",(function(){return x})),r.d(t,"actions",(function(){return $})),r.d(t,"modules",(function(){return L}));r(18),r(16),r(14),r(22),r(23);var n,o,c=r(8),l=r(0),f=(r(37),r(36),r(15),r(4)),E=r.n(f),d=r(10),O=r(7),m=r(26),S=r(50),R=r(5),T=r(9),v=r(3),P=r(114),h=r(30),j=r(155),A=r(340);function _(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function G(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?_(Object(source),!0).forEach((function(t){Object(l.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):_(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var y,C=!0;!function(e){e.PAGE_LIST="pageList"}(y||(y={}));var F,k=function(){return Object(l.a)({},y.PAGE_LIST,{1:{pageNumber:1,data:[]}})},I=Object(O.d)(k,(n={},Object(l.a)(n,y.PAGE_LIST,(function(e){return e[y.PAGE_LIST]})),Object(l.a)(n,"page",(function(e){return function(t){return e.pageList[t]}})),n));!function(e){e.REMOVE_PAGE="REMOVE_PAGE",e.RESET="RESET",e.SET_PAGE="SET_PAGE"}(F||(F={}));var x=Object(O.e)(k,(o={},Object(l.a)(o,F.SET_PAGE,(function(e,element){return E.a.set(e[y.PAGE_LIST],String(element.pageNumber),element)})),Object(l.a)(o,F.REMOVE_PAGE,(function(e,t){return delete e.pageList[t]})),Object(l.a)(o,F.RESET,(function(e){e.pageList={1:{pageNumber:1,data:[]}}})),o)),$=Object(O.a)({state:k,getters:I,mutations:x},{fetchPrograms:function(e,t){var r=this;return Object(c.a)(regeneratorRuntime.mark((function n(){var o,c,l,f,E,d,O,m,v,A,_,y,C,I,x,$,L,M,H,U,V,B,W,z,J,Y,Q,K,X,Z,ee;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.commit,c=e.dispatch,l=e.getters,n.prev=1,d=t.currentRoute,O=t.shouldFetchPreferences,m=d.query,v=d.params.id,A=r.app.$accessor.contentPageFilterState.programFilterState,console.log("fetchPrograms -> query: ",m),_=24,y=Object(P.a)(m.page,_),C=y.maxResultCount,I=y.skipCount,x=null===(f=r.app.$auth)||void 0===f?void 0:f.loggedIn,$=0,L={},M=r.app.$accessor.userPreferences,H=x,U=[],V=[],!x){n.next=35;break}if(!O){n.next=21;break}return console.log("FETCHING USER PREFERENCES!"),n.next=21,M.fetchAll(h.a.PROGRAMS);case 21:V=M.program,console.log("USER PREFERENCES -> ",V),n.t0=v,n.next=n.t0===R.a.FOLLOWING?26:n.t0===R.a.BROWSE_ALL?32:34;break;case 26:return V=M.getFollowing(h.a.PROGRAMS),console.log("FOLLOWING PREF RES ->",V),B=Object(T.n)(V,"followedAt","desc"),L.sorting="whereinids",U=B.map((function(e){return e.resourceId})),n.abrupt("break",35);case 32:return H=!1,n.abrupt("break",35);case 34:return n.abrupt("break",35);case 35:if(null===(E=r.app.$accessor.contentPageFilterState.programFilterState.filters)||void 0===E?void 0:E.length){n.next=39;break}return n.next=39,c("fetchFilters",{state:k,currentRoute:d});case 39:if(W=r.app.$accessor.contentPageFilterState.programFilterState.slugs,z=Object(j.h)(m,G({maxResultCount:C,skipCount:I,whereInIds:U},L),{slugIds:W}),console.log("fetchPrograms -> listRequest: ",z),J=r.$repositories.programs,Y={items:[],totalCount:0},!H||U.length){n.next=48;break}n.t1=Y,n.next=51;break;case 48:return n.next=50,J.getAllNew(z);case 50:n.t1=n.sent;case 51:if(Q=n.t1,console.log("fetchClasses -> response -> programsListDto: ",Q),Q){n.next=55;break}throw new Error("Invalid programs response from repository: "+Q);case 55:$=Q.totalCount,console.log("USER PREFERENCES TO MERGE: ",V.length),K=Object(T.k)(Q.items,V),Q.items=K,X=Object(j.c)(Q.items,r.app.$dayjs,x,{imageQuality:98,imageWidth:1024,mediaStyleResolution:"640x360",includeSourceSet:!0}),N(m,A,W),A.SET_NUMBER_OF_RESULTS($),w(d,X.length,r.app.i18n,r.app.$accessor,r.app.$accessor.contentPageFilterState.programFilterState.slugs),Z=A.appliedFilters,D(ee=Z.pageNumber,_,$,A),o(F.SET_PAGE,{pageNumber:ee,data:S.a.deepFreeze(X)}),console.log("fetchPrograms -> SET_PAGE: ",l.page(ee)),n.next=74;break;case 70:return n.prev=70,n.t2=n.catch(1),Object(T.i)({error:n.t2,$accessor:r.app.$accessor,i18n:r.app.i18n,config:r.$config}),n.abrupt("return",r.$handleErrorGlobally({message:null===n.t2||void 0===n.t2?void 0:n.t2.message,error:n.t2}));case 74:case"end":return n.stop()}}),n,null,[[1,70]])})))()},fetchProgramProgress:function(e){var t=this;return Object(c.a)(regeneratorRuntime.mark((function r(){var n,o,c,l,f,E,O,m,R;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,r.prev=1,o=t.app.$accessor.contentPageFilterState.classFilterState,c=o.appliedFilters,l=c.pageNumber,f=t.app.$accessor.programs.page(l),E=Object(d.cloneDeep)(null==f?void 0:f.data),O=t.$repositories.programs,m=E.map((function(e){return e.id})),r.next=11,O.getProgress(m);case 11:R=r.sent,E&&(R.progress.forEach((function(e){for(var t=0;t<E.length;t++){var element=E[t];element.dto&&element.id===e.programId&&(element.progressValue=e.numberOfClassesWatched/element.dto.numberOfClasses*100)}})),n(F.SET_PAGE,{pageNumber:l,data:S.a.deepFreeze(E)})),r.next=19;break;case 15:return r.prev=15,r.t0=r.catch(1),Object(T.i)({error:r.t0,$accessor:t.app.$accessor,i18n:t.app.i18n,config:t.$config}),r.abrupt("return",t.$handleErrorGlobally({message:null===r.t0||void 0===r.t0?void 0:r.t0.message,error:r.t0}));case 19:case"end":return r.stop()}}),r,null,[[1,15]])})))()},fetchFilters:function(e,t){var r=this;return Object(c.a)(regeneratorRuntime.mark((function e(){var n,o,c,l,f,E,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.app.$accessor.SET_CONTENT_FILTERS_ARE_LOADING(!0),n=t.query,o=r.app.$accessor.contentPageFilterState.programFilterState,c=r.$repositories.programs,e.next=7,c.filtersGetAll();case 7:l=e.sent,f=r.app.$accessor.contentPageFilterState.programFilterState.slugs,E=G({},Object(m.h)(n,f)),null!=l&&l.length&&(d={filtersDto:l,filtersToApply:E},console.log("programs -> fetchFilters -> setFilters",d),o.setFilters(d)),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0);case 16:return e.prev=16,r.app.$accessor.SET_CONTENT_FILTERS_ARE_LOADING(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,13,16,19]])})))()}});function w(e,t,r,n,o){var c=Object(T.j)({currentRoute:e,forRoute:v.a.PROGRAMS,hasResults:Boolean(t),i18n:r,slugIds:o});console.log("fetchPrograms -> _handleClassesNoResultsMessageConfig -> setNoResultsConfig: ",c),n.contentPageState.setNoResultsConfig(c)}function N(e,t,r){var n=G({},Object(m.h)(e,r));console.log("fetchPrograms -> filtersToApply: ",n),t.setSelectedFilters(n),console.log("fetchPrograms -> setAppliedFilters for ",t.filters),t.setAppliedFilters(n)}function D(e,t,r,n){var o={selectedPage:e,pagesTotal:Object(P.b)(r,t)};console.log("fetchPrograms -> _updatePagination -> updates:",o),n.updatePaginationConfig(o)}var L={detail:A}},340:function(e,t,r){"use strict";r.r(t),r.d(t,"namespaced",(function(){return A})),r.d(t,"state",(function(){return G})),r.d(t,"getters",(function(){return y})),r.d(t,"mutations",(function(){return C})),r.d(t,"actions",(function(){return F}));var n,o,c=r(32),l=r(8),f=r(0),E=(r(37),r(69),r(389),r(36),r(40),r(58),r(59),r(15),r(43),r(45),r(18),r(16),r(14),r(22),r(23),r(4)),d=r.n(E),O=r(10),m=r(7),S=r(50),R=r(9),T=r(30),v=r(155);function P(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function h(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?P(Object(source),!0).forEach((function(t){Object(f.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):P(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var j,A=!0;!function(e){e.DTO="dto",e.DATE_OF_LAST_FETCH="dateOfLastFetch"}(j||(j={}));var _,G=function(){var e;return e={},Object(f.a)(e,j.DTO,{}),Object(f.a)(e,j.DATE_OF_LAST_FETCH,""),e},y=Object(m.d)(G,(n={},Object(f.a)(n,j.DTO,(function(e){return e[j.DTO]})),Object(f.a)(n,j.DATE_OF_LAST_FETCH,(function(e){return e[j.DATE_OF_LAST_FETCH]})),n));!function(e){e.RESET_DTO="RESET_DTO",e.SET="SET"}(_||(_={}));var C=Object(m.e)(G,(o={},Object(f.a)(o,_.SET,(function(e,t){return d.a.set(e,t.key,t.data)})),Object(f.a)(o,_.RESET_DTO,(function(e){e.dto={}})),o)),F=Object(m.a)({state:G,getters:y,mutations:C},{fetch:function(e,t){var r=this;return Object(l.a)(regeneratorRuntime.mark((function n(){var o,l,f,E,d,O,m,P,h,A,G,y,C,F,k,I,x,$,w,N,D,L,M;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=e.commit,l=e.getters,n.prev=1,E=t.currentRoute,d=E.params.id,O=r.$repositories.programs,!isNaN(Number(d))){n.next=11;break}return n.next=8,O.getById(d);case 8:n.t0=n.sent,n.next=14;break;case 11:return n.next=13,O.getByLegacyId(d);case 13:n.t0=n.sent;case 14:if(m=n.t0){n.next=17;break}throw new Error("Invalid program response from repository: "+m);case 17:if(P=[],h=[],A=null===(f=r.app.$auth)||void 0===f?void 0:f.loggedIn,G=r.app.$repositories.userPreferences,y=r.app.$accessor.userPreferences,n.prev=22,!A){n.next=41;break}return F=m.programGroups,k=F.map((function(e){return e.programClasses.map((function(e){return e.videoClass.video.videoEntryId}))})).flat(),n.next=28,r.$repositories.classes.getSessions(k);case 28:return(I=n.sent)&&I.sessions&&(m=Object(v.b)(m,I.sessions)),console.log("FETCHING USER PREFERENCES FOR -> ",m.id),n.next=33,Promise.all([G.get({params:{ResourceType:T.a.PROGRAMS,ResourceId:m.id,Stats:!0}}),y.fetchAll(T.a.TEACHERS)]);case 33:x=n.sent,$=Object(c.a)(x,2),w=$[0],N=$[1],P=(null==w||null===(C=w.data)||void 0===C?void 0:C.list)||[],h=N||[],n.next=45;break;case 41:return n.next=43,G.getStats({ResourceType:T.a.PROGRAMS,ResourceId:m.id});case 43:L=n.sent,P=(null==L||null===(D=L.data)||void 0===D?void 0:D.list)||[];case 45:n.next=50;break;case 47:n.prev=47,n.t1=n.catch(22),"function"==typeof r.$handleErrorGlobally&&r.$handleErrorGlobally({message:null===n.t1||void 0===n.t1?void 0:n.t1.message,error:n.t1});case 50:return console.log("USER PREFERENCES TO MERGE: ",P.length),console.log("ALL TEACHER PREFERENCES: ",h.length),M=Object(R.k)([m],P,h),m=M[0],o(_.SET,{key:j.DATE_OF_LAST_FETCH,data:(new Date).toISOString()}),o(_.SET,{key:j.DTO,data:S.a.deepFreeze(m)}),n.abrupt("return",l.dto);case 59:return n.prev=59,n.t2=n.catch(1),"function"==typeof r.$handleErrorGlobally&&r.$handleErrorGlobally({message:null===n.t2||void 0===n.t2?void 0:n.t2.message,error:n.t2}),n.abrupt("return",Promise.reject(n.t2));case 63:case"end":return n.stop()}}),n,null,[[1,59],[22,47]])})))()},fetchProgress:function(e){var t=this;return Object(l.a)(regeneratorRuntime.mark((function r(){var n,o,c,l,f,E;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,o=e.getters,r.prev=1,c=Object(O.cloneDeep)(o[j.DTO]),l=t.$repositories.programs,r.next=6,l.getProgress([c.id]);case 6:if(f=r.sent,E=f.progress.map((function(e){return e.completedProgramClassesIds})).flat()){r.next=10;break}return r.abrupt("return");case 10:c.programGroups.map((function(e){return e.programClasses})).flat().forEach((function(e){e.isCompleted=E.includes(e.id)})),n(_.SET,{key:j.DTO,data:S.a.deepFreeze(c)}),r.next=19;break;case 15:return r.prev=15,r.t0=r.catch(1),"function"==typeof t.$handleErrorGlobally&&t.$handleErrorGlobally({message:null===r.t0||void 0===r.t0?void 0:r.t0.message,error:r.t0}),r.abrupt("return",Promise.reject(r.t0));case 19:case"end":return r.stop()}}),r,null,[[1,15]])})))()},updateItem:function(e,t){if(t){var r=h(h({},e.getters[j.DTO]),t);e.commit(_.SET,{key:j.DTO,data:r})}},updateProgramClassProgress:function(e,t){var r=this;return Object(l.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.$repositories.programs,e.next=3,n.updateProgramClassProgress(t);case 3:r.app.$accessor.programs.detail.fetch({currentRoute:r.$router.currentRoute});case 4:case"end":return e.stop()}}),e)})))()}})},342:function(e,t,r){"use strict";r.r(t),r.d(t,"namespaced",(function(){return h})),r.d(t,"state",(function(){return A})),r.d(t,"getters",(function(){return _})),r.d(t,"mutations",(function(){return G})),r.d(t,"actions",(function(){return y})),r.d(t,"modules",(function(){return C}));var n,o,c,l=r(57),f=r(8),E=r(0),d=(r(37),r(38),r(100),r(54),r(89),r(130),r(4)),O=r.n(d),m=r(7),S=r(9),R=r(3),T=r(343),v=r(5),P=r(30),h=!0;!function(e){e.PAGE_LIST="pageList",e.RESOURCES_CATEGORIES="resourcesCategories"}(c||(c={}));var j,A=function(){var e;return e={},Object(E.a)(e,c.PAGE_LIST,{1:{pageNumber:1,data:[]}}),Object(E.a)(e,c.RESOURCES_CATEGORIES,[]),e},_=Object(m.d)(A,(n={},Object(E.a)(n,c.PAGE_LIST,(function(e){return e[c.PAGE_LIST]})),Object(E.a)(n,"page",(function(e){return function(t){return e.pageList[t]}})),Object(E.a)(n,"category",(function(e){return e.resourcesCategories})),n));!function(e){e.REMOVE_PAGE="REMOVE_PAGE",e.RESET="RESET",e.SET_PAGE="SET_PAGE",e.SET_CATEGORIES="SET_CATEGORIES"}(j||(j={}));var G=Object(m.e)(A,(o={},Object(E.a)(o,j.SET_PAGE,(function(e,element){return O.a.set(e[c.PAGE_LIST],String(element.pageNumber),element)})),Object(E.a)(o,j.REMOVE_PAGE,(function(e,t){return delete e.pageList[t]})),Object(E.a)(o,j.RESET,(function(e){e.pageList={1:{pageNumber:1,data:[]}}})),Object(E.a)(o,j.SET_CATEGORIES,(function(e,t){e.resourcesCategories=t.data})),o)),y=Object(m.a)({state:A,getters:_,mutations:G},{fetchResources:function(e,t){var r=this;return Object(f.a)(regeneratorRuntime.mark((function n(){var o,c,l,f,E,d,O,m,h,A,_,G,y,C,F;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=e.commit,c=e.getters,l=t.params.id,f=t.query.search,E=c.category.find((function(e){return e.slug===l})),d=E?String(E.ID):"",O=!r.app.$auth.loggedIn,m=r.$repositories.resources,h=r.app.$accessor.userPreferences,n.next=10,m.getAllCategoryData(d);case 10:A=n.sent,_=[],n.prev=12,n.t0=l,n.next=n.t0===v.a.STYLES?16:22;break;case 16:if(h.resource.length||O){n.next=20;break}return console.log("FETCHING PREFERENCES!"),n.next=20,h.fetchAll(P.a.RESOURCE);case 20:return _=h.resource,n.abrupt("break",23);case 22:return n.abrupt("break",23);case 23:n.next=28;break;case 25:n.prev=25,n.t1=n.catch(12),console.error(n.t1);case 28:console.log("MERGIND PREFERENCES: ",_),G=Object(S.k)(A.data,_),y=Object(T.c)(G,f,l===v.a.YOGA_POSES),C=Object(T.b)(y,O,l),F=Object(S.j)({currentRoute:t,forRoute:R.a.RESOURCES,hasResults:Boolean(C.length),i18n:r.app.i18n,slugIds:[]}),console.log("fetchResources-> setNoResultsConfig: ",F),r.app.$accessor.contentPageState.setNoResultsConfig(F),o(j.SET_PAGE,{pageNumber:1,data:C}),console.log("fetchResources -> SET_PAGE: ",c.page(1));case 37:case"end":return n.stop()}}),n,null,[[12,25]])})))()},fetchCategories:function(e){var t=this;return Object(f.a)(regeneratorRuntime.mark((function r(){var n,o,c;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.commit,o=t.$repositories.resources,r.next=4,o.getAllCategories();case 4:c=r.sent,n(j.SET_CATEGORIES,{data:c});case 6:case"end":return r.stop()}}),r)})))()},updateItem:function(e,t){if(t&&t.id){var r=e.getters.page(1);if(r&&r.data.length){var n=r.data.findIndex((function(e){return e.id===t.id}));if(n>-1){var o=Object(l.a)(r.data);o.splice(n,1,t),e.commit(j.SET_PAGE,{data:o,pageNumber:1})}}}}}),C={}}}]);